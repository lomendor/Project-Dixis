# OPS STATE Archive: 2026-01-24 to 2026-01-28

**Archived**: 2026-02-02
**Source**: docs/OPS/STATE.md
**Reason**: STATE.md exceeded 1400 lines; archived passes from Jan 24-28 to maintain ≤250 lines

---

## 2026-01-28 — Pass-PRODUCER-THRESHOLD-POSTALCODE-01: Per-Producer Free Shipping Threshold

**Status**: ✅ MERGED — PR #2527 (commit `82e871d8`)

**Branch**: `feat/passPRODUCER-THRESHOLD-POSTALCODE-01`

**Objective**: Per-producer free shipping threshold + checkout postal code single source of truth.

**Scope**:
- Per-producer `free_shipping_threshold_eur` column (nullable, default NULL = use system €35)
- Producer settings UI to configure threshold
- Checkout address pre-fill for logged-in users (from saved address)
- `threshold_eur` returned in quote-cart API per producer

**Changes** (11 files, +366/-15):

| File | Change |
|------|--------|
| `backend/database/migrations/2026_01_28_120000_*` | Add `free_shipping_threshold_eur` to producers |
| `backend/app/Models/Producer.php` | fillable + casts |
| `backend/config/shipping.php` | `default_free_shipping_threshold_eur` config |
| `backend/app/Services/CheckoutService.php` | `getProducerThreshold()` helper |
| `backend/app/Http/Controllers/Api/V1/ShippingQuoteController.php` | Per-producer threshold logic |
| `backend/app/Http/Controllers/Api/AuthController.php` | `shippingAddress()` endpoint |
| `backend/routes/api.php` | Route for shipping-address |
| `frontend/src/app/(storefront)/checkout/page.tsx` | Address pre-fill on mount |
| `frontend/src/app/producer/settings/page.tsx` | Threshold input field |
| `frontend/src/lib/api.ts` | `getShippingAddress()` |
| `backend/tests/Unit/ProducerFreeShippingThresholdTest.php` | 5 unit tests |
| `backend/tests/Feature/Api/ShippingQuoteCartThresholdTest.php` | 3 feature tests |

**DoD**:
- [x] Migration adds nullable threshold column
- [x] Producer settings shows threshold field
- [x] quote-cart returns `threshold_eur` per producer
- [x] Checkout pre-fills address for logged-in users
- [x] 8 new tests (5 unit + 3 feature)
- [x] CI green (existing 10 CommissionServiceTest failures pre-exist on main)

**Evidence**: https://github.com/lomendor/Project-Dixis/pull/2527

**Baseline Test Failures Note**: 10 CommissionServiceTest failures exist on origin/main (missing `features` table) - not introduced by this pass.

---

## 2026-01-28 — Pass-ORDER-SHIPPING-SPLIT-01: Per-Producer Shipping Breakdown

**Status**: ✅ MERGED — PR #2524 (commit `57850e51`)

**Branch**: `feat/passORDER-SHIPPING-SPLIT-01`

**Objective**: Implement per-producer shipping breakdown in checkout with quote-lock verification.

---

## 2026-01-28 — Pass-CI-HYGIENE-REPAIR-02: Harden Test + Restore Prod Facts

**Status**: ✅ MERGED — PR #2521

---

## 2026-01-28 — Pass-ORDERS-E2E-SANITY-01: Production E2E Order Sanity Check

**Status**: ✅ VERIFIED

---

## 2026-01-28 — Pass-CI-FLAKE-FILTERS-SEARCH-03: Fix E2E Flaky Test

**Status**: ✅ MERGED — PR #2518

---

## 2026-01-28 — Pass-CHECKOUT-SHIPPING-DISPLAY-01: Show Shipping Cost in Checkout

**Status**: ✅ MERGED & DEPLOYED — PR #2515

---

## 2026-01-27 — Pass-SHIP-CALC-V2-PR1: Wire ShippingService into Checkout

**Status**: ✅ MERGED — PR #2507 — BACKEND ONLY

---

## 2026-01-27 — Pass-PAY-CARD-CONFIRM-GUARD-01: Card Payment Confirmation Guards

**Status**: ✅ FIXED — MERGED (PR #2504) — FRONTEND ONLY

---

## 2026-01-27 — Pass-PAY-GUEST-CARD-GATE-01: Gate Card Payment for Guests

**Status**: ✅ FIXED — MERGED (PR #2502) — FRONTEND ONLY

---

## 2026-01-27 — Pass-PAY-INIT-404-01: Fix Payment Init 404 for Guest Orders

**Status**: ✅ FIXED — MERGED (PR #2500) — PROD DEPLOYED & VERIFIED

---

## 2026-01-26 — Pass-2498-HYDRATION-418: Fix React Error #418 in CartIcon

**Status**: ✅ FIXED — MERGED (PR #2498) — PROD DEPLOYED & VERIFIED

---

## 2026-01-26 — Pass MP-SHIPPING-BREAKDOWN-TRUTH-01: Backend Single Source of Truth for Shipping

**Status**: ✅ FIXED — MERGED (PR #2496) — PROD DEPLOYED & VERIFIED

---

## 2026-01-26 — Pass CHECKOUT-COPY-02: Remove Hardcoded Prices from Note

**Status**: ✅ COMPLETE (i18n fix)

---

## 2026-01-26 — Pass CHECKOUT-COPY-01: Fix Misleading Shipping/VAT Note

**Status**: ⚠️ SUPERSEDED by CHECKOUT-COPY-02

---

## 2026-01-26 — Pass MULTI-PRODUCER-SHIPPING-AUDIT-01: Investigation Complete

**Status**: ✅ AUDIT COMPLETE (Read-Only)

---

## 2026-01-26 — Pass PAYMENT-INIT-ORDER-ID-01: Fix 404 on Payment Init (Multi-Producer)

**Status**: ✅ FIXED — MERGED (PR #2490) — PROD DEPLOYED

---

## 2026-01-26 — Pass PROD-CHECKOUT-SAFETY-01: Multi-Producer shipping_lines Aggregation

**Status**: ✅ FIXED — MERGED (PR #2488) — PROD VERIFIED

---

## 2026-01-26 — Analysis: Multi-Producer Order Data Issues

**Status**: ✅ ANALYZED — NO CODE BUG (Legacy Data Issue)

---

## 2026-01-25 — Pass GUARDRAILS-CRITICAL-FLOWS-01: Checkout Regression Guardrails

**Status**: ✅ COMPLETE (PR #2484)

---

## 2026-01-25 — Pass ORDERS-500-HYDRATION-01: Fix Orders Endpoint 500 Error

**Status**: ✅ FIXED

---

## 2026-01-25 — Pass PROD-DEPLOY-VERIFY-01: Production Deploy + Verification

**Status**: ✅ VERIFIED

---

## 2026-01-25 — Pass MP-SHIPPING-BREAKDOWN-TRUTH-01: Enable Multi-Producer Checkout

**Status**: ✅ COMPLETE

---

## 2026-01-25 — Pass CI-SMOKE-E2E-STABILIZE-01: E2E Test Stabilization

**Status**: ✅ COMPLETE

---

## 2026-01-25 — Pass MP-PAYMENT-EMAIL-TRUTH-01: Payment Email Timing

**Status**: ✅ COMPLETE

---

## 2026-01-25 — Pass MP-ORDERS-SPLIT-01: Order Splitting (Phase 2)

**Status**: ✅ COMPLETE

---

## 2026-01-25 — Pass MP-ORDERS-SCHEMA-01: Schema + Model (Phase 1)

**Status**: ✅ COMPLETE

---

## 2026-01-25 — Pass MP-ORDERS-SHIPPING-V1-PLAN-01: Multi-Producer Order Plan

**Status**: ✅ COMPLETE (plan-only)

---

## 2026-01-25 — Pass MP-PAY-EMAIL-TRUTH-01: Production Truth Verification

**Status**: ✅ VERIFIED — NO BUG ON PRODUCTION

---

## 2026-01-24 — Pass MP-PROD-VERIFY-04: Production Deployment Verification

**Status**: ✅ DEPLOYED — VERIFIED

---

## 2026-01-24 — Pass MP-CHECKOUT-PROD-TRUTH-03: HOTFIX Bypass Critical Fix

**Status**: ✅ PASS — MERGED (PR #2465)

---

## 2026-01-24 — Pass MP-MULTI-PRODUCER-CHECKOUT-02: Multi-Producer Shipping Display

**Status**: ✅ PASS — MERGED (PR #2463)

---

## 2026-01-24 — Pass MP-CHECKOUT-PAYMENT-01: Payment Success Toast Timing

**Status**: ✅ PASS — MERGED (PR #2460)

---

## 2026-01-24 — Pass MP-ORDERS-SHIPPING-V1-02: Backend Multi-Producer Shipping

**Status**: ✅ PASS — MERGED (PR #2458) + Routing Regression (PR #2459)

---

## 2026-01-24 — Pass MP-ORDERS-SHIPPING-V1-01: Schema for Per-Producer Shipping

**Status**: ✅ PASS — MERGED (PR #2456)

---

## 2026-01-24 — Pass HOTFIX-MP-CHECKOUT-GUARD-01: Block Multi-Producer Checkout

**Status**: ✅ PASS — MERGED (PR #2448, #2449) — **PROD VERIFIED**

---

## 2026-01-24 — Pass SHIP-MULTI-PRODUCER-E2E-01: E2E Test Robustness

**Status**: ✅ PASS — MERGED (PR #2445)

---

## 2026-01-24 — Pass SHIP-MULTI-PRODUCER-ENABLE-01: Enable Multi-Producer Carts

**Status**: ✅ PASS — MERGED (PR #2444)

---

## 2026-01-24 — Pass SHIP-MULTI-PRODUCER-PLAN-01: Multi-Producer & Shipping Planning

**Status**: ✅ PASS — PR Pending

---

_Full details for each pass available in original STATE.md at time of archive._
