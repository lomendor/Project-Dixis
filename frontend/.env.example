# Database (PostgreSQL)
# Local dev - use postgres:postgres for simplicity (matches CI)
DATABASE_URL="postgresql://postgres:postgres@127.0.0.1:5432/dixis?schema=public"
# CI will inject DATABASE_URL via workflow job env

NEXT_PUBLIC_API_BASE_URL=http://127.0.0.1:8001/api/v1
# Production: NEXT_PUBLIC_API_BASE_URL=https://api.dixis.gr/api/v1
# Staging: NEXT_PUBLIC_API_BASE_URL=https://staging-api.dixis.gr/api/v1

NEXT_PUBLIC_APP_URL=http://127.0.0.1:3000
# Production: NEXT_PUBLIC_APP_URL=https://app.dixis.gr
# Staging: NEXT_PUBLIC_APP_URL=https://staging-app.dixis.gr

NEXT_PUBLIC_SITE_URL=http://localhost:3000
# Production: NEXT_PUBLIC_SITE_URL=https://app.dixis.gr
# Staging: NEXT_PUBLIC_SITE_URL=https://staging-app.dixis.gr

# Stripe Configuration (Frontend)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key_here

# Pass 51: Card Payments Feature Flag (default OFF)
# Set to true to show "Κάρτα" option in checkout
NEXT_PUBLIC_PAYMENTS_CARD_FLAG=false

# Security Configuration
NEXT_ENABLE_CSP_REPORT_ONLY=false

# Basic Auth for Admin (format: username:password)
BASIC_AUTH="admin:dixis_admin_pass"

# ── Auth (OTP dev stub) ────────────────────────────────────────────────
OTP_BYPASS="000000"      # Στα tests/dev, αυτός ο κωδικός περνά πάντα
OTP_DEV_ECHO="1"         # Στο dev επιστρέφει τον κωδικό από /request-otp (ΜΗΝ το χρησιμοποιείτε production)

# ── Storage (uploads) ─────────────────────────────────────────────────
# Storage driver: fs | s3
STORAGE_DRIVER="fs"

# Optional: Enable image processing with sharp (rotate + resize up to 1200px, quality 85)
ENABLE_IMAGE_PROCESSING="false"

# S3/R2 (only if STORAGE_DRIVER=s3)
S3_BUCKET=""
S3_REGION="auto"
# Optional: custom endpoint for R2/MinIO
S3_ENDPOINT=""
S3_FORCE_PATH_STYLE="false"
# Optional public base (CDN) - supports either S3_PUBLIC_URL_BASE or S3_PUBLIC_BASE
S3_PUBLIC_URL_BASE=""
S3_PUBLIC_BASE=""
S3_ACCESS_KEY_ID=""
S3_SECRET_ACCESS_KEY=""

# ── External Notifiers (Pass 116) ────────────────────────────────────
# Twilio SMS
TWILIO_ACCOUNT_SID=""
TWILIO_AUTH_TOKEN=""
TWILIO_FROM_NUMBER=""

# SendGrid Email
SENDGRID_API_KEY=""
SENDGRID_FROM=""

# Safety toggles (set to 1 in CI/DEV to simulate delivery without external calls)
DIXIS_SMS_DISABLE="1"
DIXIS_EMAIL_DISABLE="1"

# Allow dev-only pages in production (never set to 1 in real production)
DIXIS_DEV="0"

# ── Notification Worker / Cron (Pass 117) ────────────────────────────
DIXIS_CRON_KEY="change-me-strong"

# ── API Guardrails & Ops (Passes 118–120) ────────────────────────────
# Rate limiting uses DB-backed time-bucket strategy
# Automatic cleanup via /api/jobs/maintenance/rl-clean (weekly cron)
# Ops metrics dashboard: /ops/metrics (dev-only or DIXIS_DEV=1)
ADMIN_PHONES=+306900000084

# Environment identifier
DIXIS_ENV=local

# Data provider for Orders: demo | pg | sqlite
DIXIS_DATA_SRC=demo

# ── Feature Flags (Pass AG116.1) ─────────────────────────────────────
# Landing Mode: Show coming-soon page instead of full catalog
# Set to "true" for soft launch (dixis.gr), "false" for full catalog
PUBLIC_LANDING_MODE=false

# Observability (Sentry - set in VPS only; leave empty in repo)
SENTRY_DSN=
NEXT_PUBLIC_SENTRY_DSN=
APP_VERSION=dev

# Shipping rules (public, safe)
NEXT_PUBLIC_SHIP_FREE_THRESHOLD_EUR=35
NEXT_PUBLIC_SHIP_MAX_COST=19.9
NEXT_PUBLIC_SHIP_MAINLAND_BASE=2.5
NEXT_PUBLIC_SHIP_MAINLAND_PERITEM=0.9
NEXT_PUBLIC_SHIP_ISLANDS_BASE=3.5
NEXT_PUBLIC_SHIP_ISLANDS_PERITEM=1.1

# Ops API token (set only on VPS; not in repo)
# Use a strong random string. Example: OPS_ADMIN_TOKEN=change-me-in-prod
OPS_ADMIN_TOKEN=

# API Rate Limiting (middleware)
# Παράδειγμα: 60 req/60s με μικρό burst
RL_WINDOW_MS=60000
RL_MAX=60
RL_BURST=30

# ── Email (SMTP) for order receipts (AG134) ─────────────────────────
# Set only on VPS; leave empty in repo
SMTP_HOST=
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=
SMTP_PASS=
MAIL_FROM="Dixis <no-reply@dixis.gr>"
RESEND_API_KEY=
EMAIL_DRY_RUN=true

# ── Viva Wallet Payment Gateway (AG128) ─────────────────────────────
# Environment: demo | live
VIVA_WALLET_ENV=demo
# Get credentials from Viva Wallet Merchant Dashboard
VIVA_WALLET_MERCHANT_ID=
VIVA_WALLET_API_KEY=
VIVA_WALLET_CLIENT_ID=
VIVA_WALLET_CLIENT_SECRET=
VIVA_WALLET_SOURCE_CODE=
# Payment provider: fake (testing) | viva (production)
PAYMENT_PROVIDER=fake
# Frontend needs this to know which flow to use
NEXT_PUBLIC_PAYMENT_PROVIDER=fake

# ── Internal API (server-side only) ────────────────────────────────
# Laravel backend URL for server-to-server calls (SSR / API routes)
# Falls back to NEXT_PUBLIC_API_BASE_URL if not set
LARAVEL_INTERNAL_URL=http://127.0.0.1:8001/api/v1
INTERNAL_API_URL=http://127.0.0.1:8001/api/v1

# ── Ops Endpoints ──────────────────────────────────────────────────
# Authentication tokens for /api/ops/* and /api/ci/* endpoints
# Set strong random strings on VPS; leave empty locally
OPS_TOKEN=
OPS_KEY=

# CI seed token (used by /api/ci/seed/* endpoints in test environments)
CI_SEED_TOKEN=

# ── Aggregation & Caching ─────────────────────────────────────────
# Aggregation provider for admin order facets: pg | demo (default: demo)
DIXIS_AGG_PROVIDER=demo
# Enable facets caching: 1 to enable (default: off)
DIXIS_CACHE=
# Cache TTL in milliseconds (default: 60000)
DIXIS_CACHE_TTL_MS=60000
# Enable metrics collection: 1 to enable (default: off)
DIXIS_METRICS=

# ── Email extras ───────────────────────────────────────────────────
# Reply-to address for outbound emails (default: support@dixis.gr)
MAIL_REPLY_TO="support@dixis.gr"
# Dev mailbox: set to 1 to capture emails locally instead of sending
SMTP_DEV_MAILBOX=
# Default recipient for dev mailbox (only used when SMTP_DEV_MAILBOX=1)
DEVMAIL_DEFAULT_TO=

# ── Admin ──────────────────────────────────────────────────────────
# Admin contact email for notifications (contact form, waitlist, etc.)
ADMIN_EMAIL=
# Admin email mapping for OTP verification (JSON: {"phone":"email"})
# ADMIN_EMAIL_MAPPING=

# ── Stripe (server-side) ──────────────────────────────────────────
# Stripe secret key (set only on VPS; never commit)
STRIPE_SECRET_KEY=

# ── Viva Wallet Webhooks ──────────────────────────────────────────
# Webhook verification key from Viva Wallet dashboard
VIVA_WALLET_VERIFICATION_KEY=

# ── Shipping (server-side) ────────────────────────────────────────
# Flat shipping fee in EUR (default: 3.5)
SHIPPING_FLAT_EUR=3.5
# Free shipping threshold in EUR (default: 35)
SHIPPING_FREE_OVER_EUR=35

# ── Stock Alerts ──────────────────────────────────────────────────
# Low stock threshold for admin alerts (default: 3)
LOW_STOCK_THRESHOLD=3

# ── Analytics (Pass ANALYTICS-BASIC-01) ─────────────────────────────
# Privacy-friendly, cookie-less analytics (no consent banner required)
# Provider: plausible | umami (leave empty to disable)
NEXT_PUBLIC_ANALYTICS_PROVIDER=
# Your domain (e.g., dixis.gr)
NEXT_PUBLIC_ANALYTICS_DOMAIN=
# Optional: Custom script URL (defaults to Plausible Cloud)
# NEXT_PUBLIC_ANALYTICS_SRC=https://plausible.io/js/script.js
# Required for Umami only:
# NEXT_PUBLIC_ANALYTICS_WEBSITE_ID=
